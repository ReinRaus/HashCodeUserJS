{"enabled": true, "filters": [], "urlExcludeRegex": "", "js": "", "preserveDocWrite": true, "name": "HashCode Addons", "css": "", "html": "<script>\n\nvar __addons=['__autocompleteWithLinks', '__autocompleteWithSelection', '__newAnswersAndComments', '__sortBetter'];\n\ufeffvar __addonsStarted= false;\r\n\r\nfunction __toogleEnabled(name, value){\r\n    value= value? \"yes\":\"no\";\r\n    localStorage[\"__Enable__\"+name]= value;\r\n};\r\n\r\nfunction __openSettingsPage(addonName, targetItem) {\r\n    var escapeHtml= function(text) {\r\n      return text\r\n          .replace(/&/g, \"&amp;\")\r\n          .replace(/</g, \"&lt;\")\r\n          .replace(/>/g, \"&gt;\")\r\n          .replace(/\"/g, \"&quot;\")\r\n          .replace(/'/g, \"&#039;\");\r\n    };\r\n    $(\"#__div_options .addons-leftpanel tr\").css(\"background-color\", \"#EEEEEE\");\r\n    targetItem.style.backgroundColor=\"#3060a8\";\r\n    $(\".addons-page\").css(\"display\", \"none\");\r\n    if ($(\"#__addonspage\"+addonName).html()==\"\") {\r\n        var html=\"\";\r\n        var settings= __addonsSettings.settings[addonName];\r\n        if (settings==undefined) {\r\n             html= \"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442\";\r\n        } else {\r\n             if (settings.title!=undefined) html+=\"<h3>\"+settings.title+\"</h3>\";\r\n             if (settings.description!=undefined) html+=\"<div class='addons-description'>\"+settings.description+\"</div>\";\r\n             if (settings.order!=undefined){\r\n                 html+=\"<table>\";\r\n                 for (var i=0; i<settings.order.length; i++) {\r\n                     var paramName= settings.order[i];\r\n                     var paramId= \"__addonsSettingsValue\"+addonName+\"_\"+paramName;\r\n                     var param= settings.exports[paramName];\r\n                     html+=\"<tr><td>\"+param.title+\"</td><td>\";\r\n                     if (param.type=='text') {\r\n                         html+=\"<INPUT type='text' value='\"+escapeHtml(param.value)+\"' name='\"+paramId+\"' >\";\r\n                     } else if (param.type=='checkbox') {\r\n                         html+=\"<INPUT type='checkbox' name='\"+paramId+\"' \";\r\n                         if (param.value!='0' && param.value!=0) html+=\"checked \";\r\n                         html+=\">\";\r\n                     } else if (param.type=='radio'){\r\n                         for (var j in param.options) {\r\n                             html+=\"<LABEL><INPUT type='radio' value='\"+escapeHtml(j)+\"' name='\"+paramId+\"' \";\r\n                             if (j==param.value) html+=\"checked \";\r\n                             html+=\">\"+param.options[j]+\"</LABEL>\";\r\n                         }\r\n                     } else if (param.type=='select') {\r\n                         html+=\"<SELECT name='\"+paramId+\"' value='\"+escapeHtml(param.value)+\"'>\";\r\n                         for (var j in param.options) {\r\n                             html+=\"<OPTION value='\"+escapeHtml(j)+\"' \";\r\n                             if (j==param.value) html+= \"selected \";\r\n                             html+=\">\"+param.options[j]+\"</OPTION>\";\r\n                         };\r\n                         html+=\"</SELECT>\";\r\n                     };\r\n                     html+=\"</td></tr>\";\r\n                 };\r\n                 html+=\"</table>\";\r\n             };\r\n        };\r\n        $(\"#__addonspage\"+addonName).html(html);\r\n    }\r\n    $(\"#__addonspage\"+addonName).css(\"display\", \"block\");\r\n};\r\n\r\nfunction __saveAddonsSettings() {\r\n    for (var addonName in __addonsSettings.settings) {\r\n        var settings= __addonsSettings.settings[addonName];\r\n        for (var i in settings.exports) {\r\n            var paramId= \"__addonsSettingsValue\"+addonName+\"_\"+i;\r\n            var param= settings.exports[i];\r\n            var params= document.getElementsByName(paramId);\r\n            if (params.length>0) {\r\n                if (param.type=='text' || param.type=='select') {\r\n                    var value= params[0].value;\r\n                } else if (param.type=='checkbox') {\r\n                    var value= params[0].checked?'1':'0';\r\n                } else if (param.type=='radio') {\r\n                    for (var j=0; j<params.length; j++) {\r\n                        if (params[j].checked) {\r\n                            var value= params[j].value;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                //console.log([addonName, i, value]);\r\n                __addonsSettings.settings[addonName].exports[i].value= value;\r\n            }\r\n        }\r\n    };\r\n    __addonsSettings.set();\r\n    location.reload();\r\n};\r\nfunction __addonsAddCSS (csstext) {\r\n    var head = document.getElementsByTagName('head')[0]; \r\n    var newCss = document.createElement('style'); \r\n    newCss.type = \"text/css\"; \r\n    newCss.innerHTML = csstext; \r\n    head.appendChild(newCss); \r\n} \r\n\r\nvar __addonsSettings= new (function() {\r\n    try {\r\n        this.settings= JSON.parse( localStorage['__addonsSettings'] );\r\n    } catch(e) {\r\n        console.log(e);\r\n        this.settings= {};\r\n        localStorage['__addonsSettings']= JSON.stringify(this.settings);\r\n    };\r\n    \r\n    this.get= function (addonName) {\r\n         if (this.settings[addonName] != undefined ) {\r\n              return this.settings[addonName];\r\n         } else {\r\n              return null;\r\n         }\r\n    };\r\n    \r\n    this.set= function (addonName, settings) {\r\n        if (addonName!=undefined && settings!=undefined) this.settings[addonName]= settings;\r\n        localStorage['__addonsSettings']= JSON.stringify(this.settings);\r\n    };\r\n    \r\n    this.getUpdatedSettings= function( addonName, defaultSettings ) { // \u0441\u043b\u0438\u0447\u0430\u0435\u0442 \u0441\u0442\u0430\u0440\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441 \u043d\u043e\u0432\u044b\u043c\u0438 (\u0434\u0435\u0444\u043e\u043b\u044c\u0442\u043d\u044b\u043c\u0438) \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435  (\u0442\u043e\u043b\u044c\u043a\u043e export)\r\n         if (this.settings[addonName] != undefined ) {\r\n              var oldSettings= this.settings[addonName]\r\n              var newExports= {};\r\n              var updated= false; // \u0435\u0441\u043b\u0438 \u0447\u0442\u043e-\u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u043e\u0441\u044c, \u0442\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c\r\n              for (var i in defaultSettings.exports) {\r\n                  if (oldSettings.exports[i] == undefined) { // \u0435\u0441\u043b\u0438 \u0442\u0430\u043a\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043d\u0435\u0442 \u0432 \u0441\u0442\u0430\u0440\u043e\u0439 (\u043d\u043e\u0432\u0430\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430)\r\n                      newExports[i]= defaultSettings.exports[i];\r\n                      updated= true;\r\n                  } else {\r\n                      if (defaultSettings.exports[i].type   !=oldSettings.exports[i].type ||\r\n                          defaultSettings.exports[i].title  !=oldSettings.exports[i].title ||\r\n                          defaultSettings.exports[i].options!=oldSettings.exports[i].options) {\r\n                              updated=true; // \u0441\u0440\u0430\u0432\u043d\u0438\u043b\u0438 \u0432\u0441\u0435, \u043a\u0440\u043e\u043c\u0435 value \u0438 \u0435\u0441\u0442\u044c \u043d\u0435\u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u044f\r\n                      };\r\n                      newExports[i]= defaultSettings.exports[i];\r\n                      newExports[i].value= oldSettings.exports[i].value; \r\n                  }\r\n              }\r\n              for (var i in oldSettings.exports) {\r\n                  if (newExports[i]==undefined) updated= true; // \u043a\u043b\u044e\u0447\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0435\u0442 \u0432 \u043d\u043e\u0432\u044b\u0445 \u0434\u0435\u0444\u043e\u043b\u044c\u0442\u043d\u044b\u0445\r\n              };\r\n              if (oldSettings.title!= defaultSettings.title || oldSettings.order!= defaultSettings.order || oldSettings.description!= defaultSettings.description) {\r\n                  oldSettings.title= defaultSettings.title;\r\n                  oldSettings.order= defaultSettings.order;\r\n                  oldSettings.description= defaultSettings.description;\r\n                  updated=true;\r\n              };\r\n              oldSettings.exports= newExports;\r\n              if (updated) this.set( addonName, oldSettings);\r\n              return oldSettings;\r\n         } else {\r\n              this.set(addonName, defaultSettings);\r\n              return defaultSettings;\r\n         }\r\n    };\r\n})();\r\n\r\nfunction __addonLoader() {\r\n    __addonsStarted= true;\r\n    var css= \"div.addons-settings {position: absolute; display:none; width:50%; height:50%; background-color: #EEEEEE; border:1px solid blue; max-width:51%; max-height:51%;} div.addons-overflow {overflow-y:auto; oferflow-x:hidden; height:90%; max-height:91%}; .addons-leftpanel {}; div.addons-itemlist {margin-left:0px; padding-left:0px; width:100%} .cursor-pointer {cursor:pointer} .addons-page {display:none}\";\r\n    __addonsAddCSS(css);\r\n    \r\n    var img=document.createElement('img');\r\n    img.src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACjSURBVFhH7dNBCsMwEEPRnif36c1yVe+rYBGKVpJNbALzURfNQB8E+mmjHd8T45e8QbirM/YI/K/28ZBUsJOoGA9JBTuJivGQVLCTqBgPSQU7iYrxkPQeWMh7PNsRll95dF28YDks2AXLo2XbB2971fgstru4++8UJSTGQ1LBTqJiPCQV7CQqxkNSwU6iYjwkFewkKsZD0qtgNKmiQRjNqK21H9+y+LNChwLDAAAAAElFTkSuQmCC\";\r\n    img.className='cursor-pointer';\r\n    img.style.width=img.style.height=\"16px\";\r\n    img.id= \"__imageIcon\";\r\n    img.onclick= function(e) {\r\n        if (div1.style.display==\"block\") {\r\n            div1.style.display=\"none\";\r\n        } else {\r\n            div1.style.display=\"block\";\r\n        };\r\n    };\r\n    $(img).insertBefore($(\"#searchBar div a\")[0]);\r\n    var imgRect= img.getBoundingClientRect();\r\n    \r\n    var div1= document.createElement(\"div\");\r\n    div1.className=\"addons-settings\";\r\n    div1.id= \"__div_options\";\r\n    var htmlDiv=\"<DIV class='addons-overflow'><TABLE><TR><TD width='35%' valign=top><DIV class='addons-leftpanel'><TABLE cellspacing=0>\";\r\n    var htmlDiv2=\"\";\r\n    for (var i in __addons) {\r\n        htmlDiv+=\"<TR class='addons-listitem' onclick='__openSettingsPage(\\\"\"+__addons[i]+\"\\\", this);'><TD onclick='event.stopPropagation();'><INPUT type='checkbox' onclick='__toogleEnabled(\\\"\"+__addons[i]+\"\\\", this.checked);' \";\r\n        if (localStorage[\"__Enable__\"+__addons[i]]==\"yes\") htmlDiv+=\"checked \";\r\n        try {\r\n            var name= __addonsSettings.settings[__addons[i]].title;\r\n        } catch(e) {\r\n            var name= __addons[i].replace(\"__\", \"\");\r\n        };\r\n        htmlDiv+=\"></TD><TD class='cursor-pointer'>\"+name+\"</TD></TR>\";\r\n        htmlDiv2+=\"<DIV class='addons-page' id='__addonspage\"+__addons[i]+\"'></DIV>\";\r\n    };\r\n    htmlDiv+=\"</TABLE></DIV></TD><TD width='*' valign=top>\"+htmlDiv2+\"</TD></TR></TABLE></DIV><BUTTON onclick='__saveAddonsSettings()'>\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c</BUTTON>\";\r\n    //console.log(htmlDiv);\r\n    div1.style.top=(imgRect.top+imgRect.height+5)+\"px\";\r\n    div1.style.left=(imgRect.left-150)+\"px\";\r\n    div1.innerHTML=htmlDiv;\r\n    document.body.appendChild(div1);\r\n    for (var i in __addons) {\r\n        if (localStorage[\"__Enable__\"+__addons[i]]==\"yes\") {\r\n            window[__addons[i]]();\r\n        }\r\n    }\r\n};\r\n\r\ndocument.addEventListener( \"DOMContentLoaded\", __addonLoader, false );\r\nvar __check__Started= function(){\r\n    if (!__addonsStarted) __addonLoader();\r\n};\r\nwindow.setTimeout(__check__Started, 300);\r\n\r\n\n\ufeff// @author Yura Ivanov\r\nfunction __autocompleteWithLinks() {\r\n    var defaultSettings= {\r\n        title: '\u0421\u043f\u0438\u0441\u043e\u043a \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432',\r\n        description: '\u0412\u044b\u0432\u043e\u0434\u0438\u0442 \u0440\u044f\u0434\u043e\u043c \u0441 \u043f\u043e\u043b\u044f\u043c\u0438 \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u043e\u0442\u0432\u0435\u0442\u0430 \u0438 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432 \u043f\u043b\u0430\u0448\u043a\u0443 \u0441 \u043d\u0438\u043a\u0430\u043c\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u043b\u0438 \u0443\u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u0434\u0438\u0441\u043a\u0443\u0441\u0441\u0438\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0432\u043e\u043f\u0440\u043e\u0441\u0430.<BR/>\u0412\u0441\u0442\u0430\u0432\u043a\u0430 \u043d\u0438\u043a\u0430 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430 \u0432 \u043f\u043e\u043b\u0435 \u0432\u0432\u043e\u0434\u0430 \u0432 \u043e\u0434\u0438\u043d \u043a\u043b\u0438\u043a.',\r\n        /*exports: {\r\n        },\r\n        order: []*/\r\n    };\r\n    var settings= __addonsSettings.getUpdatedSettings( arguments.callee.name, defaultSettings );\r\n    if (typeof $ != 'undefined') {\r\n        var currentLogin= $(\"#searchBar a\")[0].innerHTML.toLowerCase(); // \u043b\u043e\u0433\u0438\u043d \u0441\u0430\u043c\u043e\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430\r\n        if ($(\"#question-table\").length) {\r\n            var users = [];\r\n            var a = \"\";\r\n            function addUser(name, link, type) {\r\n                var regexClean= new RegExp(\"(?:^@)|\\\\s*\\u2666+\", 'ig');\r\n                name = name.replace(regexClean, '');\r\n                if (users.indexOf(link) < 0 && name.toLowerCase()!=currentLogin && name!=\"\") {\r\n                    users.push(link);\r\n                    return \"<li><a href='#' class='user_quote'>@\" + name\r\n                            + \"</a> - \" + type + \"</li>\";\r\n                } else {\r\n                    return \"\";\r\n                }\r\n            }\r\n            $(\"#question-table [itemprop='author'] a\").each(function(idx, u) {\r\n                var $u = $(u);\r\n                var link = $u.attr(\"href\");\r\n                var name = $u.text();\r\n                a += addUser(name, link, \"\u0442\u043e\u043f\u0438\u043a\u0441\u0442\u0430\u0440\u0442\u0435\u0440\");\r\n            });\r\n            $(\"[itemprop='comment'] [itemprop='author'] a\").each(\r\n                    function(idx, u) {\r\n                        var $u = $(u);\r\n                        var link = $u.attr(\"href\");\r\n                        var name = $u.text();\r\n                        a += addUser(name, link, \"\u043e\u0442\u0432\u0435\u0442\u0438\u043b\");\r\n                    });\r\n            $(\"a.userinfo\").each(function(idx, u) {\r\n                var $u = $(u);\r\n                var link = $u.attr(\"href\");\r\n                var name = $u.text();\r\n                a += addUser(name, link, \"\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043b\");\r\n            });\r\n            $(\"#main-body a[href^='\\/users\\/']\").each(function(idx, u) {\r\n                var $u = $(u);\r\n                var link = $u.attr(\"href\");\r\n                var name = $u.text();\r\n                a += addUser(name, link, \"\u0431\u044b\u043b \u0443\u043f\u043e\u043c\u044f\u043d\u0443\u0442\");\r\n            });\r\n            var d = $(\"<div class='users_menu' style=''><ul>\" + a\r\n                    + \"</ul></div>\");\r\n            d.insertBefore($(\"#editor, .commentBox\"));\r\n            $(\".user_quote\").click(\r\n                    function(e) {\r\n                        e.preventDefault();\r\n                        var myField = $(\"#editor, .commentBox\", $(this)\r\n                                .closest('.users_menu').parent())[0];\r\n                        if (myField.selectionStart\r\n                                || myField.selectionStart == '0') {\r\n                            var startPos = myField.selectionStart;\r\n                            var endPos = myField.selectionEnd;\r\n                            var myValue = (startPos > 0\r\n                                    && myField.value.substring(startPos - 1,\r\n                                            startPos) != ' ' ? ' ' : '')\r\n                                    + $(this).text() + ', ';\r\n                            myField.value = myField.value\r\n                                    .substring(0, startPos)\r\n                                    + myValue\r\n                                    + myField.value.substring(endPos,\r\n                                            myField.value.length);\r\n                            myField.selectionStart= myField.selectionEnd= startPos+ myValue.length;\r\n                        } else {\r\n                            myField.value += myValue;\r\n                            myField.selectionStart= myField.selectionEnd= myField.value.length;\r\n                        }\r\n                        myField.focus();\r\n                    });\r\n        }\r\n    }\r\n};\n\ufefffunction __autocompleteWithSelection() {\r\n    var defaultSettings= {\r\n        title: '\u0410\u0432\u0442\u043e\u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0441\u043e\u0431\u0430\u043a\u0438 \u043f\u043e \u043f\u0440\u043e\u0431\u0435\u043b\u0443',\r\n        description: '\u0414\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0432 \u043f\u043e\u043b\u0435 \u0432\u0432\u043e\u0434\u0430 \u0441\u043e\u0431\u0430\u043a\u0443 \u043d\u0438\u043a\u043e\u043c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430, \u043e\u0442\u043c\u0435\u0442\u0438\u0432\u0448\u0435\u0433\u043e\u0441\u044f \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435. \u0415\u0441\u043b\u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043c\u043e\u0436\u043d\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c\u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430\u043c\u0438, \u0442\u043e \u043f\u0440\u043e\u0431\u0435\u043b \u043f\u0435\u0440\u0435\u0431\u0438\u0440\u0430\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u044f. \u0415\u0441\u043b\u0438 \u043f\u0440\u043e\u0441\u0442\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0431\u0430\u043a\u0443 \u0438 \u043d\u0430\u0436\u0438\u043c\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b, \u0442\u043e \u0431\u0443\u0434\u0443\u0442 \u043f\u0435\u0440\u0435\u0431\u0438\u0440\u0430\u0442\u044c\u0441\u044f \u0432\u0441\u0435 \u043d\u0438\u043a\u0438. \u0415\u0441\u043b\u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0435 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u043d\u043e, \u0442\u043e \u043a\u0443\u0440\u0441\u043e\u0440 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u0442\u0441\u044f \u0437\u0430 \u043d\u0435\u0433\u043e. \u0427\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0441\u0442\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0431\u0430\u043a\u0443 \u043d\u0443\u0436\u043d\u043e \u043d\u0430\u0436\u0430\u0442\u044c \u0441\u043e\u0431\u0430\u043a\u0443 \u0438 \u043a\u043b\u0430\u0432\u0438\u0448\u0438 \u0432\u043b\u0435\u0432\u043e-\u0432\u043f\u0440\u0430\u0432\u043e.',\r\n        /*exports: {\r\n            test3: {type:'text', value:'sdf', title:'\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442'},\r\n            test2:  {type:'checkbox', value:'1', title:'\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442'},\r\n            test4: {type:'radio', value:'2', title:'radio', options:{'1':'opt1', '2':'opt2'} },\r\n            test1: {type:'select', value:'2', title:'radio', options:{'1':'sel1', '2':'sel2'} }\r\n        },\r\n        order: ['test2', 'test4', 'test3', 'test1']*/\r\n    };\r\n    var settings= __addonsSettings.getUpdatedSettings( arguments.callee.name, defaultSettings );\r\n    \r\n    var arrayUnique = function(a) { // \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\r\n        return a.reduce(function(p, c) {\r\n            if (p.indexOf(c) < 0) p.push(c);\r\n            return p;\r\n        }, []);\r\n    };\r\n    \r\n    // target- \u043f\u043e\u043b\u0435 \u0432\u0432\u043e\u0434\u0430, text- \u043f\u043e\u043b\u043d\u043e\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435, matchText- \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440\r\n    // \u0438\u043c\u0435\u044f \u043d\u0430 \u0432\u0445\u043e\u0434\u0435 \"test\" \u0438 \"te\" \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043e \"st\" te[st]\r\n    var completeSelection= function( target, text, matchText) {\r\n        target.value=target.value.substring(0, target.adduser+1)+text+target.value.substring(target.selectionEnd);\r\n        target.selectionStart= target.adduser+matchText.length+1;\r\n        target.selectionEnd  = target.adduser+text.length+1;\r\n        // console.log([value, target.adduser, target.selectionStart]);\r\n    };\r\n    \r\n    var currentLogin= $(\"#searchBar a\")[0].innerHTML.toLowerCase(); // \u043b\u043e\u0433\u0438\u043d \u0441\u0430\u043c\u043e\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430\r\n    var regexUsers = new RegExp(\"<a\\\\s[^>]*href\\\\s*=\\\\s*\\\"\\/users\\/\\\\d(?![^>]*\\/(?:reputation|subscriptions)\\/)[^>]*>([\\\\s\\\\S]*?)<\\/a>\", 'ig');\r\n    var users = Array();\r\n    var usersLow= Array()\r\n    var regexLoginClear1= new RegExp(\"(?:^@)|\\\\s*\\u2666+\", 'ig');\r\n    var regexLoginClear2= new RegExp(\"<span[^>]*>([^<]+)<\\/span>\", \"ig\");\r\n    // \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u043c \u0432\u0441\u0435 \u043b\u043e\u0433\u0438\u043d\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0435\u0441\u0442\u044c \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0438\u0437 \u043d\u0438\u0445 \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0432 \u043d\u0438\u0436\u043d\u0435\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0435\r\n    while ( (match=regexUsers.exec(document.body.innerHTML)) != null ) {\r\n        var userLogin= match[1].replace(regexLoginClear2, \"$1\").replace(regexLoginClear1, '');\r\n        var userLoginLow= userLogin.toLowerCase();\r\n        if (currentLogin != userLoginLow) { // \u0441\u0432\u043e\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u0435\u043c\r\n            usersLow.push(userLoginLow);\r\n            users[userLoginLow]=userLogin;\r\n        }\r\n    };\r\n    usersLow= arrayUnique(usersLow);\r\n    // \u0435\u0441\u043b\u0438 \u043a\u0443\u0440\u0441\u043e\u0440 \u0443\u0448\u0435\u043b \u0432\u043b\u0435\u0432\u043e \u043e\u0442 \u0441\u043e\u0431\u0430\u043a\u0438 \u0438\u043b\u0438 \u043d\u0430 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043f\u0440\u0430\u0432\u0435\u0435, \u0442\u043e \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u0435\u043c \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c\r\n    $(\"textarea\").bind(\"keydown\", function(e) {\r\n        if (e.target.adduser>=e.target.selectionEnd || e.target.adduser+30<e.target.selectionStart) e.target.adduser= null;\r\n    });\r\n    $(\"textarea\").bind(\"keypress\", function(e){\r\n            // \u043d\u0430\u0436\u0430\u043b\u0438 \u0441\u043e\u0431\u0430\u043a\u0443- \u043d\u0430\u0447\u0430\u043b\u0438 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c\r\n            if (e.charCode==64) {\r\n                e.target.adduser=e.target.selectionStart;\r\n            }\r\n            // \u043f\u0440\u043e\u0431\u0435\u043b\r\n            if (e.charCode==32 && e.target.adduser!=null) {\r\n                short=e.target.value.substring(e.target.adduser+1, e.target.selectionStart).toLowerCase();\r\n                long= e.target.value.substring(e.target.adduser+1, e.target.selectionEnd);\r\n                var find= null; // \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0438\u043a\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435\r\n                nextFindIsResult= (short==\"\" && long==\"\"); // \u0434\u043b\u044f \u043f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u043c, \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0431\u0435\u043b \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0441\u043e\u0431\u0430\u043a\u0438, \u0438 \u043d\u0438\u0447\u0435\u043c \u043d\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u043e, \u0442\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043f\u0435\u0440\u0432\u044b\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u0438\u0437 \u043c\u0430\u0441\u0441\u0438\u0432\u0430\r\n                for (var i in usersLow) {\r\n                    if (usersLow[i]==long.toLowerCase()) {\r\n                        nextFindIsResult=true;\r\n                        continue;\r\n                    }\r\n                    if (nextFindIsResult && usersLow[i].indexOf(short)==0) { \r\n                        find= users[usersLow[i]];\r\n                        break;\r\n                    }\r\n                }\r\n                if (nextFindIsResult && (find==null || find==\"\")) {\r\n                    for (var i in usersLow) {\r\n                        if (usersLow[i].indexOf(short)==0) {\r\n                            find= users[usersLow[i]];\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                //console.log([find, long, short]);\r\n                if (find) { // \u0435\u0441\u043b\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 \u043e\u0434\u043d\u043e, \u0442\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0437\u0430\u043f\u044f\u0442\u0443\u044e \u0438 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u043c \u043a\u0443\u0440\u0441\u043e\u0440\r\n                    if (find==long) find+=\",\";\r\n                    completeSelection(e.target, find, short);\r\n                    if (find==long+\",\") {\r\n                        e.target.selectionStart=e.target.selectionEnd;\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                }\r\n            };\r\n            // \u043a\u043d\u043e\u043f\u043a\u0438 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0435 \u043e\u0442 \u043f\u0440\u043e\u0431\u0435\u043b\u0430 \u0438 \u0441\u043e\u0431\u0430\u043a\u0438, \u043f\u044b\u0442\u0430\u0435\u043c\u0441\u044f \u043d\u0430\u0439\u0442\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435\r\n            if (e.target.adduser!=null && e.target.adduser<e.target.selectionStart) {\r\n                var short= (e.target.value.substring(e.target.adduser+1, e.target.selectionStart)+String.fromCharCode(e.charCode)).toLowerCase();\r\n                //console.log(short);\r\n                var find= null;\r\n                for (var i in usersLow) {\r\n                    if (usersLow[i].indexOf(short)==0) {\r\n                        find= users[usersLow[i]];\r\n                        break;\r\n                    }\r\n                }\r\n                if (find) {\r\n                    completeSelection(e.target, find, short);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    );\r\n};\r\n\n// @author Yura Ivanov\nfunction __newAnswersAndComments() {\n  var defaultSettings= {\n        title: '\u041f\u043e\u0434\u0441\u0432\u0435\u0442\u043a\u0430 \u043d\u043e\u0432\u044b\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439',\n        description: '\u041d\u043e\u0432\u044b\u0435 \u043e\u0442\u0432\u0435\u0442\u044b \u0438 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 \u0432\u044b\u0434\u0435\u043b\u044f\u044e\u0442\u0441\u044f \u0446\u0432\u0435\u0442\u043e\u043c, \u0447\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 \u043f\u043e\u0438\u0441\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0432 \u0432\u043e\u043f\u0440\u043e\u0441\u0435 \u0437\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0431\u044b\u0441\u0442\u0440\u0435\u0435.',\n        /*exports: {\n        },\n        order: []*/\n    };\n  var settings= __addonsSettings.getUpdatedSettings( arguments.callee.name, defaultSettings );\n  var regexURL= new RegExp(\"^https?://[^/]+/(?:questions|research)/.*$\", \"i\");\n  if (!regexURL.test(location.href)) return; // \u0435\u0441\u043b\u0438 \u043d\u0435 \u0432\u043e\u043f\u0440\u043e\u0441, \u0442\u043e \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u043c\n  var qid = $(\"a.post-vote.up\").attr(\"href\").replace('/vote/', '').replace('/up', '');\n  var qopened = window.localStorage.getItem('__opened_' + qid);\n  var readanswers = JSON.parse(window.localStorage.getItem('__read_answers_' + qid) || \"[]\");\n  var nowanswers = [];\n  $(\".answer\").each(function(i, an) {\n    var anid = $(an).attr('id').replace('answer-container-', '');\n    nowanswers.push(anid);\n    if (readanswers.indexOf(anid) < 0) {\n      if (qopened) {\n        $(an).css(\"border-left\", \"solid #5B9058 3px\");\n      }\n    }\n  });\n  var readcomments = JSON.parse(window.localStorage.getItem('__read_comments_' + qid) || \"[]\");\n  var nowcomments = [];\n  $(\".comment\").each(function(i, cm) {\n    var cmid = $(cm).attr('id').replace('comment-', '');\n    nowcomments.push(cmid);\n    if (readcomments.indexOf(cmid) < 0) {\n      if (qopened) {\n        $(cm).css(\"border-left\", \"solid #5B9058 3px\");\n      }\n    }\n  });\n  var $nav = $(\"<div class='focusedAnswer' style='border:solid #5B9058 3px;position:fixed;top:31px;left:40px;padding:10px'></div>\");\n  $nav.append(\"<span>\u041e\u0442\u0432\u0435\u0442\u044b:</span>\" + \"<ul>\" + \"<li>\u0412\u0441\u0435\u0433\u043e:\" + nowanswers.length + \"</li>\" + \"<li>\u041d\u043e\u0432\u044b\u0445:\" + (nowanswers.length - readanswers.length) + \"</li>\" + \"</ul>\" + \"<span>\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438:</span>\" + \"<ul>\" + \"<li>\u0412\u0441\u0435\u0433\u043e:\" + nowcomments.length + \"</li>\" + \"<li>\u041d\u043e\u0432\u044b\u0445:\" + (nowcomments.length - readcomments.length) + \"</li>\" + \"</ul>\");\n  $nav.appendTo(document.body);\n  window.localStorage.setItem('__read_answers_' + qid, JSON.stringify(nowanswers));\n  window.localStorage.setItem('__read_comments_' + qid, JSON.stringify(nowcomments));\n  window.localStorage.setItem('__opened_' + qid, true);\n}\n\ufefffunction __sortBetter() {\n        var defaultSettings= {\n            title: '\u0423\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u0430\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430',\n            description: '\u0423\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432.',\n            /*exports: {\n            },\n            order: []*/\n        };\n        var settings= __addonsSettings.getUpdatedSettings( arguments.callee.name, defaultSettings );\n        var userlink=$('#searchBar a').first().attr('href');\n        $('#listA')\n                .prepend(\n                                $('.short-summary.tagged-interesting')\n                                        .sort(sortQuestions)\n                        )\n                .append($('.short-summary').has('a[href=\"' +userlink+ '\"'));\n\n        function sortQuestions(a,b)\n        {\n                var $a=$(a),\n                    $b=$(b);\n                return  (value($a,'status')-value($b,'status')) ||\n                        (value($b,'votes')-value($a,'votes'));\n\n                function value($s,Class) {\n                        return parseInt($s.find('.'+Class+' .item-count').text());\n                }\n        }\n}\n\n\n</script>", "urlRegex": "^http://((meta\\.|careers\\.|math\\.|russ\\.|admin\\.|user\\.)?hashcode|bitcode|rootcode|(games|turism|foto|hm|phys|english)?\\.sezn)\\.ru"}