{"html": "<script>\n\nvar __addons=['__autocompleteWithLinks', '__autocompleteWithSelection', '__newAnswersAndComments'];\n\ufeffvar __addonsStarted= false;\r\n\r\nfunction __toogleEnabled(name, value){\r\n    value= value? \"yes\":\"no\";\r\n    localStorage[\"__Enable__\"+name]= value;\r\n};\r\n\r\nfunction __addonLoader() {\r\n    __addonsStarted= true;\r\n    var div1= document.createElement('div');\r\n    div1.style.display=\"none\";\r\n    div1.id= \"__div_options\";\r\n    var htmlDiv=\"<TABLE>\";\r\n    for (var i in __addons) {\r\n        htmlDiv+=\"<TR><TD><INPUT type='checkbox' onclick='__toogleEnabled(\\\"\"+__addons[i]+\"\\\", this.checked);' \";\r\n        if (localStorage[\"__Enable__\"+__addons[i]]==\"yes\") htmlDiv+=\"checked \";\r\n        htmlDiv+=\"></TD><TD>\"+__addons[i].replace(\"__\", \"\")+\"</TD></TR>\";\r\n    };\r\n    htmlDiv+=\"</TABLE>\";\r\n    //console.log(htmlDiv);\r\n    div1.innerHTML=htmlDiv;\r\n    var img=document.createElement('img');\r\n    img.src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACjSURBVFhH7dNBCsMwEEPRnif36c1yVe+rYBGKVpJNbALzURfNQB8E+mmjHd8T45e8QbirM/YI/K/28ZBUsJOoGA9JBTuJivGQVLCTqBgPSQU7iYrxkPQeWMh7PNsRll95dF28YDks2AXLo2XbB2971fgstru4++8UJSTGQ1LBTqJiPCQV7CQqxkNSwU6iYjwkFewkKsZD0qtgNKmiQRjNqK21H9+y+LNChwLDAAAAAElFTkSuQmCC\";\r\n    img.style.width=img.style.height=\"16px\";\r\n    img.id= \"__imageIcon\";\r\n    img.onclick= function(e) {\r\n        if (div1.style.display==\"none\") {\r\n            div1.style.display=\"block\";\r\n        } else {\r\n            div1.style.display=\"none\";\r\n        };\r\n    };\r\n    $(img).insertBefore($(\"#searchBar div a\")[0]);\r\n    $(div1).insertBefore(img);\r\n    for (var i in __addons) {\r\n        if (localStorage[\"__Enable__\"+__addons[i]]==\"yes\") {\r\n            window[__addons[i]]();\r\n        }\r\n    }\r\n};\r\n\r\ndocument.addEventListener( \"DOMContentLoaded\", __addonLoader, false );\r\nvar __check__Started= function(){\r\n    if (!__addonsStarted) __addonLoader();\r\n};\r\nwindow.setTimeout(__check__Started, 300);\r\n\r\n\n\ufeff// @author Yura Ivanov\r\nfunction __autocompleteWithLinks() {\r\n    if (typeof $ != 'undefined') {\r\n        var currentLogin= $(\"#searchBar a\")[0].innerHTML.toLowerCase(); // \u043b\u043e\u0433\u0438\u043d \u0441\u0430\u043c\u043e\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430\r\n        if ($(\"#question-table\").length) {\r\n            var users = [];\r\n            var a = \"\";\r\n            function addUser(name, link, type) {\r\n                var regexClean= new RegExp(\"(?:^@)|\\\\s*\\u2666+\", 'ig');\r\n                name = name.replace(regexClean, '');\r\n                if (users.indexOf(link) < 0 && name.toLowerCase()!=currentLogin && name!=\"\") {\r\n                    users.push(link);\r\n                    return \"<li><a href='#' class='user_quote'>@\" + name\r\n                            + \"</a> - \" + type + \"</li>\";\r\n                } else {\r\n                    return \"\";\r\n                }\r\n            }\r\n            $(\"#question-table [itemprop='author'] a\").each(function(idx, u) {\r\n                var $u = $(u);\r\n                var link = $u.attr(\"href\");\r\n                var name = $u.text();\r\n                a += addUser(name, link, \"\u0442\u043e\u043f\u0438\u043a\u0441\u0442\u0430\u0440\u0442\u0435\u0440\");\r\n            });\r\n            $(\"[itemprop='comment'] [itemprop='author'] a\").each(\r\n                    function(idx, u) {\r\n                        var $u = $(u);\r\n                        var link = $u.attr(\"href\");\r\n                        var name = $u.text();\r\n                        a += addUser(name, link, \"\u043e\u0442\u0432\u0435\u0442\u0438\u043b\");\r\n                    });\r\n            $(\"a.userinfo\").each(function(idx, u) {\r\n                var $u = $(u);\r\n                var link = $u.attr(\"href\");\r\n                var name = $u.text();\r\n                a += addUser(name, link, \"\u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043b\");\r\n            });\r\n            $(\"#main-body a[href^='\\/users\\/']\").each(function(idx, u) {\r\n                var $u = $(u);\r\n                var link = $u.attr(\"href\");\r\n                var name = $u.text();\r\n                a += addUser(name, link, \"\u0431\u044b\u043b \u0443\u043f\u043e\u043c\u044f\u043d\u0443\u0442\");\r\n            });\r\n            var d = $(\"<div class='users_menu' style=''><ul>\" + a\r\n                    + \"</ul></div>\");\r\n            d.insertBefore($(\"#editor, .commentBox\"));\r\n            $(\".user_quote\").click(\r\n                    function(e) {\r\n                        e.preventDefault();\r\n                        var myField = $(\"#editor, .commentBox\", $(this)\r\n                                .closest('.users_menu').parent())[0];\r\n                        if (myField.selectionStart\r\n                                || myField.selectionStart == '0') {\r\n                            var startPos = myField.selectionStart;\r\n                            var endPos = myField.selectionEnd;\r\n                            var myValue = (startPos > 0\r\n                                    && myField.value.substring(startPos - 1,\r\n                                            startPos) != ' ' ? ' ' : '')\r\n                                    + $(this).text() + ', ';\r\n                            myField.value = myField.value\r\n                                    .substring(0, startPos)\r\n                                    + myValue\r\n                                    + myField.value.substring(endPos,\r\n                                            myField.value.length);\r\n                            myField.selectionStart= myField.selectionEnd= startPos+ myValue.length;\r\n                        } else {\r\n                            myField.value += myValue;\r\n                            myField.selectionStart= myField.selectionEnd= myField.value.length;\r\n                        }\r\n                        myField.focus();\r\n                    });\r\n        }\r\n    }\r\n};\n\ufefffunction __autocompleteWithSelection() {\r\n\r\n    var arrayUnique = function(a) { // \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\r\n        return a.reduce(function(p, c) {\r\n            if (p.indexOf(c) < 0) p.push(c);\r\n            return p;\r\n        }, []);\r\n    };\r\n    \r\n    // target- \u043f\u043e\u043b\u0435 \u0432\u0432\u043e\u0434\u0430, text- \u043f\u043e\u043b\u043d\u043e\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435, matchText- \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440\r\n    // \u0438\u043c\u0435\u044f \u043d\u0430 \u0432\u0445\u043e\u0434\u0435 \"test\" \u0438 \"te\" \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043e \"st\" te[st]\r\n    var completeSelection= function( target, text, matchText) {\r\n        target.value=target.value.substring(0, target.adduser+1)+text+target.value.substring(target.selectionEnd);\r\n        target.selectionStart= target.adduser+matchText.length+1;\r\n        target.selectionEnd  = target.adduser+text.length+1;\r\n        // console.log([value, target.adduser, target.selectionStart]);\r\n    };\r\n    \r\n    var currentLogin= $(\"#searchBar a\")[0].innerHTML.toLowerCase(); // \u043b\u043e\u0433\u0438\u043d \u0441\u0430\u043c\u043e\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430\r\n    var regexUsers = new RegExp(\"<a\\\\s[^>]*href\\\\s*=\\\\s*\\\"\\/users\\/\\\\d(?![^>]*\\/(?:reputation|subscriptions)\\/)[^>]*>([\\\\s\\\\S]*?)<\\/a>\", 'ig');\r\n    var users = Array();\r\n    var usersLow= Array()\r\n    var regexLoginClear1= new RegExp(\"(?:^@)|\\\\s*\\u2666+\", 'ig');\r\n    var regexLoginClear2= new RegExp(\"<span[^>]*>([^<]+)<\\/span>\", \"ig\");\r\n    // \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u043c \u0432\u0441\u0435 \u043b\u043e\u0433\u0438\u043d\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0435\u0441\u0442\u044c \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0438\u0437 \u043d\u0438\u0445 \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0432 \u043d\u0438\u0436\u043d\u0435\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0435\r\n    while ( (match=regexUsers.exec(document.body.innerHTML)) != null ) {\r\n        var userLogin= match[1].replace(regexLoginClear2, \"$1\").replace(regexLoginClear1, '');\r\n        var userLoginLow= userLogin.toLowerCase();\r\n        if (currentLogin != userLoginLow) { // \u0441\u0432\u043e\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u0435\u043c\r\n            usersLow.push(userLoginLow);\r\n            users[userLoginLow]=userLogin;\r\n        }\r\n    };\r\n    usersLow= arrayUnique(usersLow);\r\n    // \u0435\u0441\u043b\u0438 \u043a\u0443\u0440\u0441\u043e\u0440 \u0443\u0448\u0435\u043b \u0432\u043b\u0435\u0432\u043e \u043e\u0442 \u0441\u043e\u0431\u0430\u043a\u0438 \u0438\u043b\u0438 \u043d\u0430 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043f\u0440\u0430\u0432\u0435\u0435, \u0442\u043e \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u0435\u043c \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c\r\n    $(\"textarea\").bind(\"keydown\", function(e) {\r\n        if (e.target.adduser>=e.target.selectionEnd || e.target.adduser+30<e.target.selectionStart) e.target.adduser= null;\r\n    });\r\n    $(\"textarea\").bind(\"keypress\", function(e){\r\n            // \u043d\u0430\u0436\u0430\u043b\u0438 \u0441\u043e\u0431\u0430\u043a\u0443- \u043d\u0430\u0447\u0430\u043b\u0438 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c\r\n            if (e.charCode==64) {\r\n                e.target.adduser=e.target.selectionStart;\r\n            }\r\n            // \u043f\u0440\u043e\u0431\u0435\u043b\r\n            if (e.charCode==32 && e.target.adduser!=null) {\r\n                short=e.target.value.substring(e.target.adduser+1, e.target.selectionStart).toLowerCase();\r\n                long= e.target.value.substring(e.target.adduser+1, e.target.selectionEnd);\r\n                var find= null; // \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0438\u043a\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435\r\n                nextFindIsResult= (short==\"\" && long==\"\"); // \u0434\u043b\u044f \u043f\u0440\u043e\u043a\u0440\u0443\u0442\u043a\u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u043c, \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0431\u0435\u043b \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0441\u043e\u0431\u0430\u043a\u0438, \u0438 \u043d\u0438\u0447\u0435\u043c \u043d\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u043e, \u0442\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043f\u0435\u0440\u0432\u044b\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u0438\u0437 \u043c\u0430\u0441\u0441\u0438\u0432\u0430\r\n                for (var i in usersLow) {\r\n                    if (usersLow[i]==long.toLowerCase()) {\r\n                        nextFindIsResult=true;\r\n                        continue;\r\n                    }\r\n                    if (nextFindIsResult && usersLow[i].indexOf(short)==0) { \r\n                        find= users[usersLow[i]];\r\n                        break;\r\n                    }\r\n                }\r\n                if (nextFindIsResult && (find==null || find==\"\")) {\r\n                    for (var i in usersLow) {\r\n                        if (usersLow[i].indexOf(short)==0) {\r\n                            find= users[usersLow[i]];\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                //console.log([find, long, short]);\r\n                if (find) { // \u0435\u0441\u043b\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 \u043e\u0434\u043d\u043e, \u0442\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0437\u0430\u043f\u044f\u0442\u0443\u044e \u0438 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u043c \u043a\u0443\u0440\u0441\u043e\u0440\r\n                    if (find==long) find+=\",\";\r\n                    completeSelection(e.target, find, short);\r\n                    if (find==long+\",\") {\r\n                        e.target.selectionStart=e.target.selectionEnd;\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                }\r\n            };\r\n            // \u043a\u043d\u043e\u043f\u043a\u0438 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0435 \u043e\u0442 \u043f\u0440\u043e\u0431\u0435\u043b\u0430 \u0438 \u0441\u043e\u0431\u0430\u043a\u0438, \u043f\u044b\u0442\u0430\u0435\u043c\u0441\u044f \u043d\u0430\u0439\u0442\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435\r\n            if (e.target.adduser!=null && e.target.adduser<e.target.selectionStart) {\r\n                var short= (e.target.value.substring(e.target.adduser+1, e.target.selectionStart)+String.fromCharCode(e.charCode)).toLowerCase();\r\n                //console.log(short);\r\n                var find= null;\r\n                for (var i in usersLow) {\r\n                    if (usersLow[i].indexOf(short)==0) {\r\n                        find= users[usersLow[i]];\r\n                        break;\r\n                    }\r\n                }\r\n                if (find) {\r\n                    completeSelection(e.target, find, short);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    );\r\n};\r\n\n// @author Yura Ivanov\nfunction __newAnswersAndComments() {\n  var regexURL= new RegExp(\"^https?://[^/]+/questions/.*$\", \"i\");\n  if (!regexURL.test(location.href)) return; // \u0435\u0441\u043b\u0438 \u043d\u0435 \u0432\u043e\u043f\u0440\u043e\u0441, \u0442\u043e \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u043c\n  var qid = $(\"a.post-vote.up\").attr(\"href\").replace('/vote/', '').replace('/up', '');\n  var qopened = window.localStorage.getItem('__opened_' + qid);\n  var readanswers = JSON.parse(window.localStorage.getItem('__read_answers_' + qid) || \"[]\");\n  var nowanswers = [];\n  $(\".answer\").each(function(i, an) {\n    var anid = $(an).attr('id').replace('answer-container-', '');\n    nowanswers.push(anid);\n    if (readanswers.indexOf(anid) < 0) {\n      if (qopened) {\n        $(an).css(\"border-left\", \"solid #5B9058 3px\");\n      }\n    }\n  });\n  var readcomments = JSON.parse(window.localStorage.getItem('__read_comments_' + qid) || \"[]\");\n  var nowcomments = [];\n  $(\".comment\").each(function(i, cm) {\n    var cmid = $(cm).attr('id').replace('comment-', '');\n    nowcomments.push(cmid);\n    if (readcomments.indexOf(cmid) < 0) {\n      if (qopened) {\n        $(cm).css(\"border-left\", \"solid #5B9058 3px\");\n      }\n    }\n  });\n  var $nav = $(\"<div class='focusedAnswer' style='border:solid #5B9058 3px;position:fixed;top:31px;left:40px;padding:10px'></div>\");\n  $nav.append(\"<span>\u041e\u0442\u0432\u0435\u0442\u044b:</span>\" + \"<ul>\" + \"<li>\u0412\u0441\u0435\u0433\u043e:\" + nowanswers.length + \"</li>\" + \"<li>\u041d\u043e\u0432\u044b\u0445:\" + (nowanswers.length - readanswers.length) + \"</li>\" + \"</ul>\" + \"<span>\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438:</span>\" + \"<ul>\" + \"<li>\u0412\u0441\u0435\u0433\u043e:\" + nowcomments.length + \"</li>\" + \"<li>\u041d\u043e\u0432\u044b\u0445:\" + (nowcomments.length - readcomments.length) + \"</li>\" + \"</ul>\");\n  $nav.appendTo(document.body);\n  window.localStorage.setItem('__read_answers_' + qid, JSON.stringify(nowanswers));\n  window.localStorage.setItem('__read_comments_' + qid, JSON.stringify(nowcomments));\n  window.localStorage.setItem('__opened_' + qid, true);\n}\n\n</script>", "enabled": true, "name": "HashCode Addons", "js": "", "urlRegex": "^http://((meta\\.|careers\\.|math\\.|russ\\.|admin\\.|user\\.)?hashcode|bitcode|rootcode|(games|turism|foto|hm|phys|english)?\\.sezn)\\.ru", "css": "", "preserveDocWrite": true, "urlExcludeRegex": "", "filters": []}